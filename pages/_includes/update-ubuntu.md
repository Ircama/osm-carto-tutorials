
The goal for this procedure is to use [Ubuntu packages](https://en.wikipedia.org/wiki/Ubuntu_(operating_system)#Package_classification_and_support) and official [PPA](https://developer.ubuntu.com/en/publish/other-forms-of-submitting-apps/ppa/)s whenever possible.

We consider using [Ubuntu](https://en.wikipedia.org/wiki/Ubuntu_(operating_system)) 16.04.1 LTS [Xenial Xerus](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_16.04_LTS_.28Xenial_Xerus.29), Ubuntu 15.4 [Vivid Vervet](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_15.04_.28Vivid_Vervet.29) or Ubuntu 14.04.3 LTS [Trusty Tahr](https://en.wikipedia.org/wiki/Ubuntu_version_history#Ubuntu_14.04_LTS_.28Trusty_Tahr.29) (other versions should work). All should be [64-bit](https://en.wikipedia.org/wiki/64-bit_computing) computing architecture.

Other distributions like Debian might require changes and are not tested.

This procedure is updated to the version of OpenStreetMap Carto available at the time of writing. To get the correct installation procedure, the [INSTALL history](https://github.com/gravitystorm/openstreetmap-carto/blame/master/INSTALL.md) should be checked, considering that the OpenStreetMap Carto maintainers use to keep the [INSTALL](https://github.com/gravitystorm/openstreetmap-carto/blob/master/INSTALL.md) page updated. Check also the [README changelog](https://github.com/gravitystorm/openstreetmap-carto/blame/master/README.md).

## General setup for Ubuntu

### Update Ubuntu

Make sure your Ubuntu system is fully up-to-date:

    lsb_release -a

Previous command returns the Ubuntu version.

To update the system:

```shell
sudo apt-get update
sudo apt-get -y upgrade
```

If on a brand new system you also want to do `sudo apt-get dist-upgrade && sudo shutdown -r now`.

### Install essential tools

    sudo apt-get -y install curl unzip gdal-bin tar wget bzip2 build-essential clang

For the subsequent installation steps, we suppose that `cd` defaults to your home directory.

### Configure a swap

Importing and managing map data takes a lot of RAM and a swap is generally needed.

To check whether a swap partition is already configured on your system, use one of the following two commands:

* Reports the swap usage summary (no output means missing swap):

      swapon -s

* Display amount of free and used memory in the system (check the line specifying *Swap*):

      free -h

If you do not have an active swap partition, especially if your physical memory is small, you should add a swap file. First we use `fallocate` command to create a file. For example, create a file named *swapfile* with 2G capacity in root file system:

    sudo fallocate -l 2G /swapfile

Then make sure only *root* can read and write to it.

    sudo chmod 600 /swapfile

Format it to swap:

    sudo mkswap /swapfile

Enable the swap file

    sudo swapon /swapfile
    
The Operating System tuning adopted by the OpenStreetMap tile servers can be found in the related [Chef configuration](https://github.com/openstreetmap/chef/blob/master/roles/tile.rb#L49-L63).

### Check usage of English locale

Run locale to list what locales are currently defined for the current user account:

    locale

To set the en_US locale:

    export LANGUAGE=en_US.UTF-8
    export LANG=en_US.UTF-8
    export LC_ALL=en_US.UTF-8

The exported variables can be put to the file `/etc/environment`.

New locales can also be generated by issuing:

    sudo locale-gen en_US en_US.UTF-8
    sudo dpkg-reconfigure locales
